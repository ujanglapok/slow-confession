<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sebuah surat untukmu</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
    <!-- Tambahkan di <head> -->
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">

    <style>
        /* === RESET & VARIABLES === */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --rose: #FF6B8B;
            --soft-pink: #FFE4EC;
            --deep-pink: #FF4D6D;
            --cream: #FFF0F3;
            --text: #5A3D4A;
        }
        
        body {
            font-family: 'Georgia', serif;
            background: var(--cream);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
            line-height: 1.6;
        }
        
        /* === INTRO PAGE === */
        .intro-page {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: linear-gradient(135deg, var(--rose) 0%, #FF8FA3 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 1s ease;
            padding: 20px;
        }
        
        .intro-content {
            text-align: center;
            color: white;
            max-width: 600px;
            animation: fadeInUp 1s ease;
        }
        
        .intro-heart {
            font-size: 4em;
            animation: heartbeat 1.5s infinite;
            margin-bottom: 20px;
        }
        
        .intro-title {
            font-size: 2.5em;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        
        .intro-subtitle {
            font-size: 1.2em;
            opacity: 0.9;
            margin-bottom: 30px;
            font-style: italic;
        }
        
        .begin-btn {
            background: white;
            color: var(--rose);
            border: none;
            padding: 15px 40px;
            font-size: 1.1em;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }
        
        .begin-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(0,0,0,0.3);
        }
        
        /* === LETTER CONTAINER === */
        .letter-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px;
            opacity: 0;
            animation: fadeIn 1s 0.5s forwards;
        }
        
        .envelope {
            background: white;
            border-radius: 20px;
            padding: 60px 40px;
            box-shadow: 0 20px 60px rgba(255,107,139,0.15);
            border: 2px solid var(--soft-pink);
            position: relative;
            overflow: hidden;
        }
        
        .envelope::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 5px;
            background: linear-gradient(90deg, var(--rose), var(--deep-pink));
        }
        
        .seal {
            position: absolute;
            top: -25px; right: 40px;
            width: 50px; height: 50px;
            background: var(--rose);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5em;
            box-shadow: 0 5px 15px rgba(255,107,139,0.3);
            animation: sealPulse 3s infinite;
        }
        
        /* === LETTER CONTENT === */
        .letter-header {
            text-align: center;
            margin-bottom: 50px;
            padding-bottom: 30px;
            border-bottom: 2px dashed var(--soft-pink);
        }
        
        .recipient {
            font-size: 2.8em;
            color: var(--deep-pink);
            margin-bottom: 10px;
            font-family: 'Dancing Script', cursive;
        }
        
        .date-place {
            color: #888;
            font-style: italic;
            margin-bottom: 30px;
        }
        
        .letter-body {
            font-size: 1.15em;
        }
        
        .paragraph {
            margin-bottom: 35px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.8s ease;
            padding: 20px;
            background: var(--cream);
            border-radius: 15px;
            border-left: 4px solid transparent;
        }
        
        .paragraph.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .paragraph:nth-child(odd) { border-left-color: var(--rose); }
        .paragraph:nth-child(even) { border-left-color: var(--deep-pink); }
        
        .paragraph:hover {
            transform: translateX(10px);
            background: white;
            box-shadow: 0 5px 20px rgba(255,107,139,0.1);
        }
        
        .highlight {
            color: var(--deep-pink);
            font-weight: bold;
            background: var(--soft-pink);
            padding: 2px 8px;
            border-radius: 4px;
        }
        
        /* === RESPONSE BUTTONS === */
        .response-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 50px 0;
            flex-wrap: wrap;
        }
        
        .response-btn {
            padding: 15px 30px;
            border: none;
            border-radius: 50px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s;
            min-width: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .yes-btn {
            background: var(--rose);
            color: white;
            box-shadow: 0 8px 25px rgba(255,107,139,0.3);
        }
        
        .no-btn {
            background: transparent;
            color: var(--text);
            border: 2px solid var(--soft-pink);
        }
        
        .response-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(255,107,139,0.2);
        }
        
        /* === CLOSING === */
        .closing {
            text-align: center;
            margin-top: 60px;
            padding-top: 40px;
            border-top: 2px dashed var(--soft-pink);
            opacity: 0;
            animation: fadeIn 1s 2s forwards;
        }
        
        .signature {
            font-family: 'Times New Roman', Times, serif;
            font-size: 2.5em;
            color: var(--rose);
            margin: 20px 0;
        }
        
        .ps-note {
            font-style: italic;
            color: #888;
            margin-top: 20px;
            font-size: 0.95em;
        }
        
        /* === FLOATING HEARTS === */
        .floating-heart {
            position: fixed;
            font-size: 24px;
            color: var(--rose);
            opacity: 0;
            pointer-events: none;
            z-index: -1;
        }
        
        /* === MODAL === */
        .response-modal {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.5s;
        }
        
        .response-modal.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            background: white;
            padding: 50px;
            border-radius: 20px;
            max-width: 500px;
            text-align: center;
            transform: scale(0.7);
            transition: transform 0.5s;
        }
        
        .response-modal.active .modal-content {
            transform: scale(1);
        }
        
        /* === MUSIC PLAYER === */
        .music-player {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 25px;
            padding: 10px 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 1000;
            border: 1px solid var(--soft-pink);
            animation: slideInRight 0.5s ease forwards;
            backdrop-filter: blur(10px);
        }
        
        .music-control-btn {
            background: var(--rose);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1em;
            transition: all 0.3s;
            flex-shrink: 0;
        }
        
        .music-control-btn:hover {
            background: var(--deep-pink);
            transform: scale(1.1);
        }
        
        .music-control-btn.playing {
            animation: pulse 2s infinite;
        }
        
        .volume-control {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .volume-slider {
            width: 100px;
            height: 4px;
            -webkit-appearance: none;
            background: var(--soft-pink);
            border-radius: 2px;
        }
        
        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: var(--rose);
            cursor: pointer;
            border: 2px solid white;
        }
        
        /* === MODAL BUTTONS === */
        .modal-confirm-btn {
            background: var(--rose);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Georgia', serif;
        }
        
        .modal-confirm-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(255,107,139,0.3);
        }
        
        .modal-ok-btn {
            background: var(--soft-pink);
            color: var(--text);
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Georgia', serif;
        }
        
        .modal-ok-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(255,107,139,0.2);
        }

        /* === FEEDBACK FORM MODAL === */
        .feedback-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 3000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.5s;
            padding: 20px;
        }

        .feedback-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .feedback-content {
            background: white;
            border-radius: 25px;
            padding: 40px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            transform: translateY(30px);
            transition: transform 0.5s;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .feedback-modal.active .feedback-content {
            transform: translateY(0);
        }

        .feedback-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .feedback-heart {
            font-size: 3em;
            animation: heartbeat 1.5s infinite;
            margin-bottom: 15px;
        }

        .feedback-header h2 {
            color: var(--deep-pink);
            margin-bottom: 10px;
            font-size: 1.8em;
        }

        .feedback-header p {
            color: #888;
            font-style: italic;
        }

        /* Feedback Options */
        .feedback-options {
            margin: 25px 0;
        }

        .feedback-option {
            display: flex;
            align-items: center;
            padding: 15px;
            margin-bottom: 15px;
            border: 2px solid var(--soft-pink);
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
            background: var(--cream);
        }

        .feedback-option:hover {
            transform: translateY(-3px);
            border-color: var(--rose);
            box-shadow: 0 8px 20px rgba(255,107,139,0.15);
        }

        .feedback-option.selected {
            border-color: var(--deep-pink);
            background: var(--soft-pink);
            transform: translateY(-3px);
        }

        .option-icon {
            font-size: 2em;
            margin-right: 15px;
            min-width: 50px;
            text-align: center;
        }

        .option-text h3 {
            color: var(--text);
            margin-bottom: 5px;
            font-size: 1.1em;
        }

        .option-text p {
            color: #666;
            font-size: 0.9em;
        }

        /* Personal Message */
        .personal-message {
            margin: 25px 0;
        }

        .personal-message textarea {
            width: 100%;
            height: 120px;
            padding: 15px;
            border: 2px solid var(--soft-pink);
            border-radius: 15px;
            font-family: 'Georgia', serif;
            font-size: 1em;
            resize: none;
            transition: all 0.3s;
            background: var(--cream);
            color: var(--text);
        }

        .personal-message textarea:focus {
            outline: none;
            border-color: var(--rose);
            box-shadow: 0 0 15px rgba(255,107,139,0.2);
        }

        .personal-message textarea::placeholder {
            color: #aaa;
            font-style: italic;
        }

        .char-counter {
            text-align: right;
            font-size: 0.85em;
            color: #888;
            margin-top: 5px;
        }

        /* Feedback Buttons */
        .feedback-buttons {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }

        .feedback-send-btn {
            flex: 2;
            background: var(--rose);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 15px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Georgia', serif;
        }

        .feedback-send-btn:hover {
            background: var(--deep-pink);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255,107,139,0.3);
        }

        .feedback-send-btn.sending {
            background: #ccc;
            cursor: not-allowed;
        }

        .feedback-cancel-btn {
            flex: 1;
            background: transparent;
            color: var(--text);
            border: 2px solid var(--soft-pink);
            padding: 15px;
            border-radius: 15px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Georgia', serif;
        }

        .feedback-cancel-btn:hover {
            border-color: var(--rose);
            transform: translateY(-3px);
        }

        .feedback-note {
            text-align: center;
            font-size: 0.85em;
            color: #888;
            margin-top: 20px;
            font-style: italic;
        }

        /* Loading animation */
        .loading-dots {
            display: inline-block;
        }

        .loading-dots::after {
            content: '...';
            animation: dots 1.5s steps(4, end) infinite;
        }

        /* === TOUR GUIDE STYLES (UNLIMITED) === */
        #musicGuide {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.5s ease;
            padding: 20px;
        }

        .guide-content {
            background: white;
            border-radius: 20px;
            padding: 25px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: slideUp 0.5s ease;
            border: 2px solid var(--rose);
        }

        .guide-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--soft-pink);
            padding-bottom: 15px;
        }

        .guide-icon {
            font-size: 2.5em;
            margin-right: 15px;
            animation: heartbeat 1.5s infinite;
        }

        .guide-header h3 {
            color: var(--deep-pink);
            font-size: 1.5em;
            flex-grow: 1;
            margin: 0;
        }

        .guide-close {
            background: none;
            border: none;
            font-size: 1.2em;
            color: var(--text);
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .guide-close:hover {
            background: var(--soft-pink);
        }

        .guide-body {
            margin: 20px 0;
        }

        .guide-body p {
            font-size: 1.1em;
            margin-bottom: 15px;
            color: var(--text);
            text-align: center;
        }

        .highlight-emoji {
            background: var(--soft-pink);
            padding: 5px 10px;
            border-radius: 10px;
            font-size: 1.3em;
            display: inline-block;
            animation: bounce 1s infinite;
        }

        .guide-animation {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 25px 0;
        }

        .arrow {
            font-size: 2em;
            animation: bounce 1s infinite;
            margin-bottom: 10px;
        }

        .music-btn-demo {
            background: var(--rose);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            animation: pulse 2s infinite;
        }

        .guide-tip {
            font-style: italic;
            color: var(--deep-pink);
            background: var(--soft-pink);
            padding: 10px;
            border-radius: 10px;
            margin-top: 20px !important;
        }

        .guide-footer {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .guide-ok-btn, .guide-show-btn {
            flex: 1;
            padding: 12px 20px;
            border: none;
            border-radius: 12px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Georgia', serif;
        }

        .guide-ok-btn {
            background: var(--soft-pink);
            color: var(--text);
        }

        .guide-show-btn {
            background: var(--rose);
            color: white;
        }

        .guide-ok-btn:hover, .guide-show-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255,107,139,0.2);
        }

        /* HINT BUTTON STYLES */
        .hint-button {
            position: fixed;
            bottom: 80px;
            right: 20px;
            background: var(--deep-pink);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 1.2em;
            cursor: pointer;
            z-index: 1001;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: float 3s ease-in-out infinite;
        }

        .hint-button:hover {
            transform: scale(1.1) rotate(10deg);
            box-shadow: 0 8px 25px rgba(255,107,139,0.3);
        }

        .quick-hint {
            position: fixed;
            bottom: 140px;
            right: 20px;
            z-index: 1002;
            animation: fadeInUp 0.5s ease;
            max-width: 250px;
        }

        .hint-bubble {
            background: white;
            padding: 15px 20px;
            border-radius: 15px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.15);
            border: 2px solid var(--rose);
            position: relative;
        }

        .hint-bubble p {
            margin: 8px 0;
            color: var(--text);
            font-size: 0.95em;
        }

        .hint-bubble strong {
            color: var(--deep-pink);
        }

        .hint-emoji {
            background: var(--soft-pink);
            padding: 2px 8px;
            border-radius: 8px;
            animation: heartbeat 1.5s infinite;
        }

        .hint-arrow {
            text-align: center;
            font-size: 1.2em;
            color: var(--rose);
            animation: bounce 1s infinite;
            margin-top: 10px;
        }

        .hint-bubble::after {
            content: '';
            position: absolute;
            bottom: -10px;
            right: 30px;
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-top: 10px solid var(--rose);
        }

        .hint-bubble::before {
            content: '';
            position: absolute;
            bottom: -8px;
            right: 30px;
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-top: 10px solid white;
            z-index: 1;
        }

        /* PULSE ATTENTION */
        .pulse-attention {
            animation: attentionPulse 2s infinite !important;
            position: relative;
        }

        .pulse-attention::after {
            content: 'üéµ';
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--deep-pink);
            color: white;
            font-size: 0.7em;
            padding: 3px 5px;
            border-radius: 50%;
            animation: blink 1.5s infinite;
        }

        /* === MUSIC SELECTOR STYLES === */
        .music-selector-btn {
            background: none;
            border: none;
            color: var(--deep-pink);
            cursor: pointer;
            padding: 5px 8px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: 5px;
            transition: all 0.3s;
            font-size: 1.1em;
        }
        
        .music-selector-btn:hover {
            background: var(--soft-pink);
            transform: rotate(15deg);
        }
        
        .music-selector-modal {
            position: fixed;
            bottom: 80px;
            right: 20px;
            background: rgba(255, 255, 255, 0.98);
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            z-index: 1001;
            border: 1px solid var(--soft-pink);
            backdrop-filter: blur(10px);
            display: none;
            animation: fadeInUp 0.3s ease;
            width: 220px;
            max-width: 90vw;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .music-selector-modal.show {
            display: block;
        }
        
        .selector-title {
            font-size: 0.9em;
            color: var(--deep-pink);
            margin-bottom: 10px;
            font-weight: bold;
            text-align: center;
            border-bottom: 1px solid var(--soft-pink);
            padding-bottom: 8px;
            position: sticky;
            top: 0;
            background: rgba(255, 255, 255, 0.98);
            z-index: 1;
        }
        
        .music-option {
            display: flex;
            align-items: center;
            padding: 10px 12px;
            margin: 6px 0;
            background: var(--cream);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .music-option:hover {
            background: white;
            transform: translateX(5px);
            box-shadow: 0 3px 10px rgba(255,107,139,0.15);
        }
        
        .music-option.active {
            background: var(--soft-pink);
            border-color: var(--rose);
            position: relative;
        }
        
        .music-option.active::after {
            content: 'üéµ';
            margin-left: auto;
            animation: heartbeat 1.5s infinite;
        }
        
        .option-emoji {
            margin-right: 10px;
            font-size: 1.2em;
            min-width: 24px;
            text-align: center;
        }
        
        .option-text {
            font-size: 0.9em;
            color: var(--text);
            flex-grow: 1;
        }
        
        .selector-close {
            position: absolute;
            top: 8px;
            right: 8px;
            background: none;
            border: none;
            color: var(--text);
            cursor: pointer;
            padding: 4px;
            border-radius: 50%;
            font-size: 0.9em;
            opacity: 0.6;
            z-index: 2;
        }
        
        .selector-close:hover {
            background: var(--soft-pink);
            opacity: 1;
        }

        /* === CONFIRMATION MODAL STYLES === */
        .confirmation-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.85);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 4000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.5s;
            padding: 20px;
        }

        .confirmation-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .confirmation-content {
            background: white;
            border-radius: 25px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            transform: translateY(30px);
            transition: transform 0.5s;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            border: 2px solid var(--rose);
        }

        .confirmation-modal.active .confirmation-content {
            transform: translateY(0);
        }

        .confirmation-header {
            margin-bottom: 25px;
        }

        .confirmation-heart {
            font-size: 3em;
            animation: heartbeat 1.5s infinite;
            margin-bottom: 15px;
        }

        .confirmation-header h2 {
            color: var(--deep-pink);
            margin-bottom: 10px;
            font-size: 1.8em;
        }

        .confirmation-header p {
            color: #666;
            font-size: 1.1em;
            line-height: 1.5;
        }

        .confirmation-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .confirmation-yes-btn {
            flex: 1;
            background: var(--rose);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 15px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Georgia', serif;
        }

        .confirmation-yes-btn:hover {
            background: var(--deep-pink);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255,107,139,0.3);
        }

        .confirmation-no-btn {
            flex: 1;
            background: transparent;
            color: var(--text);
            border: 2px solid var(--soft-pink);
            padding: 15px;
            border-radius: 15px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Georgia', serif;
        }

        .confirmation-no-btn:hover {
            border-color: var(--rose);
            transform: translateY(-3px);
        }

        /* === DIRECT RESPONSE MODAL (untuk "Aku Juga Merasa Sama") === */
        .direct-response-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 3500;
            opacity: 0;
            visibility: hidden;
            transition: all 0.5s;
            padding: 20px;
        }

        .direct-response-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .direct-response-content {
            background: white;
            border-radius: 25px;
            padding: 40px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            transform: translateY(30px);
            transition: transform 0.5s;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            border: 2px solid var(--rose);
        }

        .direct-response-modal.active .direct-response-content {
            transform: translateY(0);
        }

        .direct-response-header {
            text-align: center;
            margin-bottom: 25px;
            border-bottom: 2px solid var(--soft-pink);
            padding-bottom: 20px;
        }

        .direct-response-heart {
            font-size: 3.5em;
            animation: heartbeat 1.5s infinite;
            margin-bottom: 15px;
        }

        .direct-response-header h2 {
            color: var(--deep-pink);
            margin-bottom: 15px;
            font-size: 1.8em;
        }

        .direct-response-header p {
            color: #666;
            font-style: italic;
        }

        .direct-response-body {
            margin: 25px 0;
            padding: 25px;
            background: var(--cream);
            border-radius: 20px;
        }

        .direct-response-body h3 {
            color: var(--deep-pink);
            margin-bottom: 15px;
            font-size: 1.3em;
            text-align: center;
        }

        .direct-response-textarea {
            width: 100%;
            height: 150px;
            padding: 20px;
            border: 2px solid var(--soft-pink);
            border-radius: 15px;
            font-family: 'Georgia', serif;
            font-size: 1em;
            resize: none;
            margin-bottom: 15px;
            background: white;
            color: var(--text);
        }

        .direct-response-textarea:focus {
            outline: none;
            border-color: var(--rose);
            box-shadow: 0 0 15px rgba(255,107,139,0.2);
        }

        .direct-response-char-counter {
            text-align: right;
            font-size: 0.85em;
            color: #888;
            margin-bottom: 20px;
        }

        .direct-response-buttons {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }

        .direct-response-send-btn {
            flex: 2;
            background: var(--rose);
            color: white;
            border: none;
            padding: 16px;
            border-radius: 15px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Georgia', serif;
        }

        .direct-response-send-btn:hover {
            background: var(--deep-pink);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255,107,139,0.3);
        }

        .direct-response-cancel-btn {
            flex: 1;
            background: transparent;
            color: var(--text);
            border: 2px solid var(--soft-pink);
            padding: 16px;
            border-radius: 15px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Georgia', serif;
        }

        .direct-response-cancel-btn:hover {
            border-color: var(--rose);
            transform: translateY(-3px);
        }

        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60%, 100% { content: '...'; }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }

        @keyframes attentionPulse {
            0% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(255,107,139,0.7);
            }
            50% {
                transform: scale(1.1);
                box-shadow: 0 0 0 15px rgba(255,107,139,0);
            }
            100% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(255,107,139,0);
            }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        /* === ANIMATIONS === */
        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes fadeIn {
            to { opacity: 1; }
        }
        
        @keyframes sealPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(50px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255,107,139,0.7); }
            70% { box-shadow: 0 0 0 10px rgba(255,107,139,0); }
            100% { box-shadow: 0 0 0 0 rgba(255,107,139,0); }
        }
        
        @keyframes heartExplode {
            0% { transform: translate(-50%, -50%) scale(0); opacity: 1; }
            50% { transform: translate(-50%, -50%) scale(2); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(4); opacity: 0; }
        }

        /* === RESPONSIVE DESIGN === */
        @media (max-width: 768px) {
            /* Fix buttons centering */
            .response-buttons {
                flex-direction: column;
                align-items: center;
                gap: 15px;
                padding: 0 10px;
                margin: 40px 0;
            }
            
            .response-btn {
                width: 100%;
                max-width: 320px;
                padding: 16px 25px;
                font-size: 1.1em;
                border-radius: 25px;
                margin: 0;
            }
            
            /* Fix button text alignment */
            .response-btn span {
                font-size: 1.2em;
                margin-right: 10px;
            }
            
            /* Fix music player untuk mobile */
            .music-player {
                bottom: 15px;
                right: 15px;
                padding: 8px 12px;
                border-radius: 20px;
                gap: 8px;
                background: rgba(255, 255, 255, 0.98);
                box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            }
            
            /* Volume control sederhana untuk mobile */
            .volume-control {
                display: flex;
                align-items: center;
                gap: 6px;
            }
            
            .volume-slider {
                width: 60px;
                height: 4px;
            }
            
            .volume-icon {
                font-size: 0.8em;
                min-width: 18px;
            }
            
            /* Fix envelope padding */
            .envelope {
                padding: 40px 20px;
                margin: 0;
            }
            
            /* Fix recipient name untuk mobile */
            .recipient {
                font-size: 2.2em;
                padding: 0 10px;
                line-height: 1.3;
                word-break: break-word;
            }
            
            /* Fix paragraph text */
            .paragraph {
                padding: 15px;
                font-size: 1.05em;
                line-height: 1.7;
                margin-bottom: 25px;
            }
            
            /* Fix modal untuk mobile */
            .modal-content {
                padding: 30px 20px;
                margin: 20px;
                max-width: 90%;
            }
            
            /* Fix intro untuk mobile */
            .intro-title {
                font-size: 2em;
            }
            
            .intro-subtitle {
                font-size: 1.1em;
            }
            
            .begin-btn {
                padding: 14px 35px;
            }

            /* Responsive Feedback */
            .feedback-content {
                padding: 25px 20px;
                margin: 10px;
            }
            
            .feedback-option {
                padding: 12px;
            }
            
            .option-icon {
                font-size: 1.5em;
                min-width: 40px;
            }
            
            .option-text h3 {
                font-size: 1em;
            }
            
            .option-text p {
                font-size: 0.85em;
            }
            
            .feedback-buttons {
                flex-direction: column;
            }
            
            .personal-message textarea {
                height: 100px;
            }

            /* Responsive tour guide */
            .guide-content {
                padding: 20px;
                width: 95%;
            }
            
            .guide-header h3 {
                font-size: 1.3em;
            }
            
            .guide-body p {
                font-size: 1em;
            }
            
            .guide-footer {
                flex-direction: column;
            }
            
            .hint-button {
                bottom: 70px;
                right: 15px;
                width: 45px;
                height: 45px;
                font-size: 1.1em;
            }
            
            .quick-hint {
                bottom: 125px;
                right: 15px;
                max-width: 220px;
            }
            
            .hint-bubble {
                padding: 12px 15px;
            }

            /* Responsive music selector */
            .music-selector-modal {
                bottom: 75px;
                right: 15px;
                width: 200px;
                padding: 12px;
                max-height: 250px;
            }

            /* Responsive confirmation modal */
            .confirmation-content {
                padding: 25px 20px;
                margin: 10px;
            }

            .confirmation-buttons {
                flex-direction: column;
            }

            .direct-response-content {
                padding: 25px 20px;
                margin: 10px;
            }

            .direct-response-body {
                padding: 15px;
            }

            .direct-response-buttons {
                flex-direction: column;
            }

            .direct-response-textarea {
                height: 120px;
                padding: 15px;
            }
        }
        
        /* Extra small devices */
        @media (max-width: 480px) {
            .response-btn {
                max-width: 280px;
                padding: 14px 20px;
                font-size: 1em;
            }
            
            .recipient {
                font-size: 1.8em;
            }
            
            .music-player {
                bottom: 10px;
                right: 10px;
                padding: 6px 10px;
            }
            
            .volume-slider {
                width: 50px;
            }
            
            .music-control-btn {
                width: 36px;
                height: 36px;
                font-size: 1em;
            }
            
            .letter-container {
                padding: 20px 15px;
            }
            
            .envelope {
                padding: 30px 15px;
            }
            
            .seal {
                top: -20px;
                right: 20px;
                width: 40px;
                height: 40px;
                font-size: 1.2em;
            }
            
            .closing {
                margin-top: 40px;
                padding-top: 30px;
            }
            
            .signature {
                font-size: 2em;
            }

            /* Tour guide small devices */
            .guide-content {
                padding: 15px;
            }
            
            .guide-header h3 {
                font-size: 1.2em;
            }
            
            .music-btn-demo {
                width: 40px;
                height: 40px;
                font-size: 1.3em;
            }
            
            .arrow {
                font-size: 1.8em;
            }
            
            .hint-button {
                bottom: 60px;
                right: 10px;
                width: 40px;
                height: 40px;
                font-size: 1em;
            }
            
            .quick-hint {
                bottom: 110px;
                right: 10px;
                max-width: 180px;
            }
            
            .hint-bubble {
                padding: 10px 12px;
                font-size: 0.9em;
            }

            /* Music selector small devices */
            .music-selector-modal {
                bottom: 70px;
                right: 10px;
                width: 180px;
                padding: 10px;
                max-height: 220px;
            }
            
            .music-option {
                padding: 8px 10px;
            }
            
            .option-text {
                font-size: 0.85em;
            }

            /* Confirmation modal small */
            .confirmation-content {
                padding: 20px 15px;
            }

            .confirmation-header h2 {
                font-size: 1.5em;
            }

            .direct-response-content {
                padding: 20px 15px;
            }

            .direct-response-header h2 {
                font-size: 1.5em;
            }

            .direct-response-textarea {
                height: 100px;
                padding: 12px;
            }
        }
        
        /* Landscape mode fixes */
        @media (max-width: 768px) and (orientation: landscape) {
            .intro-content {
                max-width: 90%;
            }
            
            .music-player {
                bottom: 10px;
                right: 10px;
            }
            
            .envelope {
                padding: 30px 20px;
            }
            
            .paragraph {
                padding: 12px;
                margin-bottom: 20px;
            }

            .direct-response-content {
                max-height: 90vh;
            }
        }
        
        /* Tablet fixes */
        @media (min-width: 769px) and (max-width: 1024px) {
            .letter-container {
                max-width: 700px;
                padding: 30px;
            }
            
            .envelope {
                padding: 50px 30px;
            }
            
            .recipient {
                font-size: 2.4em;
            }
        }
    </style>
</head>
<body>
    <!-- Audio Element -->
    <audio id="backgroundMusic" loop preload="auto">
        <source src="pelengkap1.mp3" type="audio/mpeg">
        Browser tidak mendukung audio.
    </audio>
    
    <!-- TAMBAHAN AUDIO UNTUK TRACK 4 & 5 -->
    <audio id="musicTrack4" preload="auto">
        <source src="lagu4.mp3" type="audio/mpeg">
    </audio>
    <audio id="musicTrack5" preload="auto">
        <source src="lagu5.mp3" type="audio/mpeg">
    </audio>
    
    <!-- Music Player -->
    <div class="music-player" id="musicPlayer" style="display: none;">
        <button id="musicToggle" class="music-control-btn">
            <span class="music-icon">üéµ</span>
        </button>
        <div class="volume-control">
            <span class="volume-icon">üîä</span>
            <input type="range" id="volumeSlider" min="0" max="100" value="30" class="volume-slider">
        </div>
    </div>
    
    <!-- Intro Page -->
    <div class="intro-page" id="introPage">
        <div class="intro-content">
            <div class="intro-heart">üíå</div>
            <h1 class="intro-title">Sebuah Surat dariku untukmu</h1>
            <p class="intro-subtitle">Untuk seseorang yang ku kagumi</p>
            <p style="margin-bottom: 30px; font-size: 1.1em;">Ada sesuatu yang ingin kusampaikan kepadamu</p>
            <button class="begin-btn" id="beginBtn">Silahkan dibuka surat ini</button>
            <p style="margin-top: 30px; font-size: 0.9em; opacity: 0.7;">Dibuat dengan penuh perasaan</p>
        </div>
    </div>
    
    <!-- Letter Container -->
    <div class="letter-container" id="letterContainer">
        <div class="envelope">
            <div class="seal">‚ù§Ô∏è</div>
            
            <div class="letter-header">
                <h1 class="recipient" id="recipientName">Untukmu Syahar Banu</h1>
                <p class="date-place" id="datePlace">Hari ini, </p>
            </div>
            
            <div class="letter-body">
                <div class="paragraph" id="para1">
                    <p>Mungkin ini terdengar aneh, namun ada yang ingin aku sampaikan kepadamu: <span class="highlight"> kalau aku mengagumi dirimu.</span>. Bukan sekedar mengagumi biasa, tapi perasaan yang tumbuh sudah lama yang ber-iringan dengan waktu, dan mengisi setiap ruang di hatiku.</p>
                </div>
                <div class="paragraph" id="para2">
                    <p>Setiap kali aku melihat ada dirimu, dunia seolah menjadi lebih cerah. Dan setiap kali aku berpapasan denganmu waktu terasa berlalu terlalu cepat. Dan aku merasakan <span class="highlight">Kenyamanan</span>, saat <span class="highlight">melihatmu</span> walaupun hanya sekedar melihatmu.</p>
                </div>
                <div class="paragraph" id="para3">
                    <p>Aku tahu kita semua punya kekurangan. Tapi justru itulah yang membuatku semakin tertarik kepadamu apa adanya bukan ada apanya, dengan segala apapun yang kamu miliki. Kamu tidak perlu menjadi sempurna, karena versi kamu yang sekarang sudah <span class="highlight">cukup berarti</span> bagiku.</p>
                </div>
                <div class="paragraph" id="para4">
                    <p>Mungkin kamu bertanya-tanya mengapa baru sekarang aku mengungkap kan perasaanku? Karena aku lelah menyimpan semua ini sendirian. Karena setiap kali aku melihatmu tanpa mengatakan yang sebenarnya terasa seperti <span class="highlight">menahan napas</span>. Dan aku ingin bernapas lega, ingin jujur tentang apa yang kurasakan.</p>
                </div>
                <div class="paragraph" id="para5">
                    <p>Ini bukan tentang memaksakan sesuatu. Ini hanya tentang <span class="highlight">kejujuran</span>. Dan memberanikan diri mengatakan, "Jika, kamu berarti bagiku lebih dari yang mungkin kamu sadari."</p>
                </div>
                <div class="paragraph" id="para6">
                    <p>Aku meminta maaf jika surat ini membuat mu ilfeel atau membuat mu <span class="highlight"> tidak nyaman (risih) </span> saat membuka maupun saat membaca surat ini. aku hanya ingin mengungkap kan perasaan ku yang sudah ku pendam sejak lama dan hanya bisa mengagumi mu selama ini.</p>
                </div>
            </div>
            
            <div class="response-buttons">
                <button class="response-btn yes-btn" id="yesBtn"><span>‚ù§Ô∏è</span> Aku Juga Merasa Sama</button>
                <button class="response-btn no-btn" id="noBtn"><span>üí≠</span> Aku Perlu Waktu</button>
            </div>
            
            <div class="closing">
                <p>Apapun responsmu, terima kasih sudah meluangkan waktu untuk membaca surat dariku.</p>
                <div class="signature">
                    Dariku,<br>
                    <span style="border-bottom: 2px dashed var(--rose); padding: 0 10px; color: var(--deep-pink); 
                    font-weight: bold; font-family: Arial, sans-serif; user-select: none; -webkit-user-select: none;">
                       Musa
                    </span>
                </div>
                <h1 class="recipient" id="recipientName" style="color: var(--deep-pink); font-weight: bold; font-family: Arial, Helvetica, sans-serif;">Untukmu
                    Banun</h1>
            </div>
        </div>
    </div>
    
    <!-- Response Modal -->
    <div class="response-modal" id="responseModal">
        <div class="modal-content" id="modalContent"></div>
    </div>
    
    <!-- Confirmation Modal (untuk konfirmasi sebelum kirim) -->
    <div class="confirmation-modal" id="confirmationModal">
        <div class="confirmation-content" id="confirmationContent">
            <!-- Content akan diisi oleh JavaScript -->
        </div>
    </div>
    
    <!-- Direct Response Modal (untuk "Aku Juga Merasa Sama") -->
    <div class="direct-response-modal" id="directResponseModal">
        <div class="direct-response-content">
            <div class="direct-response-header">
                <div class="direct-response-heart">üíñ</div>
                <h2>Aku Juga Merasa Sama!</h2>
                <p>Bagikan perasaanmu dengan menulis pesan</p>
            </div>
            
            <div class="direct-response-body">
                <h3>Kirim pesan balasan untuk Musa</h3>
                <textarea id="directResponseMessage" class="direct-response-textarea" 
                          placeholder="Tulis pesan balasanmu disini... Contoh: Aku juga merasakan hal yang sama seperti kamu..." 
                          maxlength="500"></textarea>
                <div class="direct-response-char-counter">
                    <span id="directCharCount">0</span>/500 karakter
                </div>
            </div>
            
            <div class="direct-response-buttons">
                <button class="direct-response-send-btn" id="directResponseSendBtn">Kirim Balasan üíå</button>
                <button class="direct-response-cancel-btn" id="directResponseCancelBtn">Nanti Saja</button>
            </div>
        </div>
    </div>
    
    <!-- Feedback Form Modal -->
    <div class="feedback-modal" id="feedbackModal">
        <div class="feedback-content">
            <div class="feedback-header">
                <div class="feedback-heart">üíù</div>
                <h2>Apa jawabanmu??</h2>
                <p> Aku ingin tau apa jawaban mu</p>
            </div>
            
            <div class="feedback-options">
                <div class="feedback-option" data-value="suka">
                    <div class="option-icon">üòä</div>
                    <div class="option-text">
                        <h3>Apakah kamu menerima ungkapan ku?</h3>
                        <p>Iyaa, aku menerima surat ungakapan darimu.</p>
                    </div>
                </div>
                
                <div class="feedback-option" data-value="ragu">
                    <div class="option-icon">ü§î</div>
                    <div class="option-text">
                        <h3>Aku masih ragu</h3>
                        <p>Beri aku waktu untuk memikirkan ini yaa</p>
                    </div>
                </div>
            </div>
            
            <div class="personal-message">
                <textarea id="personalMessage" placeholder="Tulis jawaban disini yaaa" 
                          maxlength="500"></textarea>
                <div class="char-counter"><span id="charCount">0</span>/500 karakter</div>
            </div>
            
            <div class="feedback-buttons">
                <button class="feedback-send-btn" id="sendFeedback">Kirim Jawabanku ‚úâÔ∏è</button>
                <button class="feedback-cancel-btn" id="cancelFeedback">Nanti Saja</button>
            </div>
            
            <p class="feedback-note">Jawabanmu akan aku terima</p>
        </div>
    </div>
    
    <script>
        // === TELEGRAM BOT CONFIGURATION ===
        const TELEGRAM_CONFIG = {
            BOT_TOKEN: '8437150175:AAFEOp1cDuUKq6unN0Z1vTj4Oe5WrebjjSo',
            CHAT_ID: '1933585104',
            TEST_MODE: false // Set true untuk testing lokal, false untuk production
        };

        // === VARIABLES ===
        let observer = null;
        let isMusicPlaying = false;
        let currentVolume = 0.3;
        let selectedFeedbackOption = null;
        let currentResponseType = null; // 'yes' atau 'no'
        
        // === DOM ELEMENTS ===
        const introPage = document.getElementById('introPage');
        const letterContainer = document.getElementById('letterContainer');
        const beginBtn = document.getElementById('beginBtn');
        const yesBtn = document.getElementById('yesBtn');
        const noBtn = document.getElementById('noBtn');
        const responseModal = document.getElementById('responseModal');
        const modalContent = document.getElementById('modalContent');
        const recipientName = document.getElementById('recipientName');
        const datePlace = document.getElementById('datePlace');
        const backgroundMusic = document.getElementById('backgroundMusic');
        const musicPlayer = document.getElementById('musicPlayer');
        const musicToggle = document.getElementById('musicToggle');
        const volumeSlider = document.getElementById('volumeSlider');
        const feedbackModal = document.getElementById('feedbackModal');
        const sendFeedbackBtn = document.getElementById('sendFeedback');
        const cancelFeedbackBtn = document.getElementById('cancelFeedback');
        const personalMessage = document.getElementById('personalMessage');
        const charCount = document.getElementById('charCount');
        const confirmationModal = document.getElementById('confirmationModal');
        const confirmationContent = document.getElementById('confirmationContent');
        const directResponseModal = document.getElementById('directResponseModal');
        const directResponseMessage = document.getElementById('directResponseMessage');
        const directCharCount = document.getElementById('directCharCount');
        const directResponseSendBtn = document.getElementById('directResponseSendBtn');
        const directResponseCancelBtn = document.getElementById('directResponseCancelBtn');

        // === INITIALIZE ===
        document.addEventListener('DOMContentLoaded', function() {
            // Set tanggal
            const now = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            datePlace.textContent = `${now.toLocaleDateString('id-ID', options)}, di mana pun kamu berada`;
            
            // Setup musik
            backgroundMusic.volume = currentVolume;
            volumeSlider.value = currentVolume * 100;
            
            // Event listeners
            beginBtn.addEventListener('click', beginLetter);
            yesBtn.addEventListener('click', () => showConfirmation('yes'));
            noBtn.addEventListener('click', () => showConfirmation('no'));
            musicToggle.addEventListener('click', toggleMusic);
            volumeSlider.addEventListener('input', updateVolume);
            
            // Hati awal
            createFloatingHearts(3);
            
            // No button effect
            noBtn.addEventListener('mouseover', function() {
                this.style.transform = 'translateX(20px)';
                setTimeout(() => this.style.transform = 'translateX(0)', 300);
            });
            
            // Setup feedback form
            setupFeedbackForm();
            
            // Setup direct response form
            setupDirectResponseForm();
            
            // Mobile volume icon update
            updateVolumeIcon();
            
            // Inisialisasi fitur musik tambahan
            initializeMusicFeatures();
            
            // Inisialisasi tour guide
            initializeTourGuide();
        });

        // === SET NAMA DEFAULT ===
        const defaultSenderName = "Someone who liked you";
        const defaultRecipientName = "For You";

        // === LETTER FUNCTIONS ===
        function beginLetter() {
            introPage.style.opacity = '0';
            setTimeout(() => {
                introPage.style.display = 'none';
                letterContainer.scrollIntoView({ behavior: 'smooth' });
                musicPlayer.style.display = 'flex';
                createFloatingHearts(15);
                startParagraphAnimations();
                // Auto play musik
                if (!isMusicPlaying) {
                    setTimeout(() => playBackgroundMusic(), 500);
                }
                // Tampilkan tour guide setelah 2 detik
                setTimeout(() => {
                    showMusicGuide();
                }, 2000);
            }, 1000);
        }
        
        function startParagraphAnimations() {
            const paragraphs = document.querySelectorAll('.paragraph');
            observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                        if (!entry.target.hasAttribute('data-heart-added')) {
                            createFloatingHearts(2);
                            entry.target.setAttribute('data-heart-added', 'true');
                        }
                    }
                });
            }, { threshold: 0.3 });
            paragraphs.forEach(para => observer.observe(para));
        }
        
        function createFloatingHearts(count) {
            const heartTypes = ['‚ù§Ô∏è', 'üíñ', 'üíó', 'üíì', 'üíû'];
            for (let i = 0; i < count; i++) {
                setTimeout(() => {
                    const heart = document.createElement('div');
                    heart.className = 'floating-heart';
                    heart.innerHTML = heartTypes[Math.floor(Math.random() * heartTypes.length)];
                    heart.style.left = Math.random() * 100 + 'vw';
                    heart.style.top = '100vh';
                    heart.style.fontSize = (Math.random() * 20 + 15) + 'px';
                    heart.style.opacity = '0.8';
                    document.body.appendChild(heart);
                    
                    const duration = Math.random() * 3000 + 2000;
                    setTimeout(() => {
                        heart.style.transition = `all ${duration}ms cubic-bezier(0.4, 0, 0.2, 1)`;
                        heart.style.opacity = '0';
                        heart.style.transform = `translateY(-${window.innerHeight + 100}px) rotate(${Math.random() * 360}deg)`;
                        setTimeout(() => heart.remove(), duration);
                    }, Math.random() * 1000);
                }, i * 100);
            }
        }

        // === CONFIRMATION MODAL FUNCTIONS ===
        function showConfirmation(type) {
            currentResponseType = type;
            
            let title = '';
            let message = '';
            let emoji = '';
            
            if (type === 'yes') {
                title = 'Kamu yakin?';
                message = 'Apakah kamu yakin ingin mengirim jawaban <strong>"Aku Juga Merasa Sama"</strong>?';
                emoji = 'üíñ';
            } else {
                title = 'Kamu yakin?';
                message = 'Apakah kamu yakin ingin mengirim jawaban <strong>"Aku Perlu Waktu"</strong>?';
                emoji = 'üí≠';
            }
            
            confirmationContent.innerHTML = `
                <div class="confirmation-header">
                    <div class="confirmation-heart">${emoji}</div>
                    <h2>${title}</h2>
                    <p>${message}</p>
                    <p style="font-style: italic; margin-top: 15px; color: #888;">
                        Jawabanmu akan dikirim dan tidak bisa diubah
                    </p>
                </div>
                <div class="confirmation-buttons">
                    <button class="confirmation-yes-btn" id="confirmYesBtn">
                        Ya, kirim jawaban ini
                    </button>
                    <button class="confirmation-no-btn" id="confirmNoBtn">
                        Tidak, batalkan
                    </button>
                </div>
            `;
            
            confirmationModal.classList.add('active');
            document.body.style.overflow = 'hidden';
            
            // Setup event listeners untuk tombol konfirmasi
            document.getElementById('confirmYesBtn').addEventListener('click', handleConfirmedResponse);
            document.getElementById('confirmNoBtn').addEventListener('click', hideConfirmationModal);
        }
        
        function hideConfirmationModal() {
            confirmationModal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }
        
        function handleConfirmedResponse() {
            hideConfirmationModal();
            
            if (currentResponseType === 'yes') {
                // Tampilkan modal langsung untuk "Aku Juga Merasa Sama"
                showDirectResponseModal();
            } else {
                // Untuk "Aku Perlu Waktu", langsung kirim ke Telegram
                showResponse('no');
            }
        }

        // === DIRECT RESPONSE MODAL FUNCTIONS (untuk "Aku Juga Merasa Sama") ===
        function setupDirectResponseForm() {
            // Character counter untuk textarea
            directResponseMessage.addEventListener('input', function() {
                const count = this.value.length;
                directCharCount.textContent = count;
                
                // Change color if approaching limit
                if (count > 450) {
                    directCharCount.style.color = 'var(--deep-pink)';
                    directCharCount.style.fontWeight = 'bold';
                } else {
                    directCharCount.style.color = '#888';
                    directCharCount.style.fontWeight = 'normal';
                }
            });
            
            // Send button
            directResponseSendBtn.addEventListener('click', function() {
                const message = directResponseMessage.value.trim();
                
                if (message.length < 5) {
                    alert('Tolong tulis pesan balasan minimal 5 karakter ya üòä');
                    return;
                }
                
                // Prepare data untuk Telegram
                const feedbackData = {
                    option: 'suka',
                    message: message,
                    recipient: "Musa",
                    timestamp: new Date().toISOString()
                };
                
                // Kirim ke Telegram
                sendToTelegram(feedbackData, 'direct');
            });
            
            // Cancel button
            directResponseCancelBtn.addEventListener('click', hideDirectResponseModal);
        }
        
        function showDirectResponseModal() {
            directResponseModal.classList.add('active');
            document.body.style.overflow = 'hidden';
            
            // Reset form
            directResponseMessage.value = '';
            directCharCount.textContent = '0';
            
            // Focus ke textarea
            setTimeout(() => {
                directResponseMessage.focus();
            }, 300);
            
            // Celebration efek
            createFloatingHearts(10);
        }
        
        function hideDirectResponseModal() {
            directResponseModal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        // === MUSIC FUNCTIONS ===
        function toggleMusic() {
            if (isMusicPlaying) {
                pauseBackgroundMusic();
            } else {
                playBackgroundMusic();
            }
        }
        
        function playBackgroundMusic() {
            backgroundMusic.play().then(() => {
                isMusicPlaying = true;
                updateMusicUI();
                if (!musicToggle.hasAttribute('data-first-play')) {
                    createFloatingHearts(8);
                    musicToggle.setAttribute('data-first-play', 'true');
                }
            }).catch((error) => {
                console.log("Playback error:", error);
                isMusicPlaying = false;
                updateMusicUI();
                musicToggle.innerHTML = '<span class="music-icon">‚ñ∂Ô∏è</span>';
            });
        }
        
        function pauseBackgroundMusic() {
            backgroundMusic.pause();
            isMusicPlaying = false;
            updateMusicUI();
        }
        
        function updateVolume() {
            currentVolume = volumeSlider.value / 100;
            backgroundMusic.volume = currentVolume;
            updateVolumeIcon();
        }
        
        function updateVolumeIcon() {
            const volumeIcon = document.querySelector('.volume-icon');
            if (volumeIcon) {
                volumeIcon.textContent = currentVolume === 0 ? 'üîá' : 
                                         currentVolume < 0.3 ? 'üîà' : 'üîä';
            }
        }
        
        function updateMusicUI() {
            const playIcon = isMusicPlaying ? '‚è∏Ô∏è' : '‚ñ∂Ô∏è';
            musicToggle.innerHTML = `<span class="music-icon">${playIcon}</span>`;
            if (isMusicPlaying) {
                musicToggle.classList.add('playing');
            } else {
                musicToggle.classList.remove('playing');
            }
        }

        // === FEEDBACK FORM FUNCTIONS ===
        function setupFeedbackForm() {
            // Setup feedback option selection
            document.querySelectorAll('.feedback-option').forEach(option => {
                option.addEventListener('click', function() {
                    // Hapus selected dari semua
                    document.querySelectorAll('.feedback-option').forEach(opt => {
                        opt.classList.remove('selected');
                    });
                    
                    // Tambah selected ke yang diklik
                    this.classList.add('selected');
                    selectedFeedbackOption = this.getAttribute('data-value');
                    
                    // Efek visual
                    createFloatingHearts(2);
                });
            });
            
            // Character counter untuk textarea
            personalMessage.addEventListener('input', function() {
                const count = this.value.length;
                charCount.textContent = count;
                
                // Change color if approaching limit
                if (count > 450) {
                    charCount.style.color = 'var(--deep-pink)';
                    charCount.style.fontWeight = 'bold';
                } else {
                    charCount.style.color = '#888';
                    charCount.style.fontWeight = 'normal';
                }
            });
            
            // Send feedback button
            sendFeedbackBtn.addEventListener('click', function() {
                if (!selectedFeedbackOption) {
                    alert('Pilih salah satu perasaanmu dulu ya üòä');
                    return;
                }
                
                // Prepare feedback data
                const feedbackData = {
                    option: selectedFeedbackOption,
                    message: personalMessage.value.trim(),
                    recipient: "Musa",
                    timestamp: new Date().toISOString()
                };
                
                // Kirim ke Telegram
                sendToTelegram(feedbackData, 'feedback');
            });
            
            // Cancel button
            cancelFeedbackBtn.addEventListener('click', hideFeedbackForm);
        }
        
        function showFeedbackForm() {
            feedbackModal.classList.add('active');
            document.body.style.overflow = 'hidden';
            
            // Reset form
            selectedFeedbackOption = null;
            personalMessage.value = '';
            charCount.textContent = '0';
            
            // Hapus semua selected class
            document.querySelectorAll('.feedback-option').forEach(option => {
                option.classList.remove('selected');
            });
        }
        
        function hideFeedbackForm() {
            feedbackModal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        // === TELEGRAM BOT FUNCTIONS ===
        async function sendToTelegram(feedbackData, source = 'feedback') {
            try {
                // Update button state berdasarkan source
                if (source === 'direct') {
                    directResponseSendBtn.innerHTML = 'Sedang Mengirim...<span class="loading-dots"></span>';
                    directResponseSendBtn.classList.add('sending');
                    directResponseSendBtn.disabled = true;
                } else if (source === 'feedback') {
                    sendFeedbackBtn.innerHTML = 'Sedang Mengirim...<span class="loading-dots"></span>';
                    sendFeedbackBtn.classList.add('sending');
                    sendFeedbackBtn.disabled = true;
                }
                
                if (TELEGRAM_CONFIG.TEST_MODE) {
                    // Simulasi untuk testing lokal
                    console.log('üì® [TEST MODE] Feedback data:', feedbackData);
                    console.log('üì® [TEST MODE] Would send to Telegram:', formatTelegramMessage(feedbackData, '127.0.0.1'));
                    
                    // Simulate success after delay
                    setTimeout(() => {
                        if (source === 'direct') {
                            directResponseSendBtn.innerHTML = '‚úÖ [TEST] Terkirim!';
                        } else {
                            sendFeedbackBtn.innerHTML = '‚úÖ [TEST] Terkirim!';
                        }
                        
                        saveFeedbackToLocalStorage(feedbackData);
                        
                        setTimeout(() => {
                            showFeedbackConfirmation(feedbackData, source);
                            // Reset button
                            setTimeout(() => {
                                if (source === 'direct') {
                                    directResponseSendBtn.innerHTML = 'Kirim Balasan üíå';
                                    directResponseSendBtn.classList.remove('sending');
                                    directResponseSendBtn.disabled = false;
                                } else {
                                    sendFeedbackBtn.innerHTML = 'Kirim Jawabanku üíå';
                                    sendFeedbackBtn.classList.remove('sending');
                                    sendFeedbackBtn.disabled = false;
                                }
                            }, 2000);
                        }, 1000);
                    }, 1500);
                    return;
                }
                
                // Get user IP (optional)
                let userIP = 'Tidak terdeteksi';
                try {
                    const ipResponse = await fetch('https://api.ipify.org?format=json');
                    const ipData = await ipResponse.json();
                    userIP = ipData.ip;
                } catch (ipError) {
                    console.log('IP tidak terdeteksi:', ipError);
                }
                
                // Format message untuk Telegram
                const message = formatTelegramMessage(feedbackData, userIP);
                
                // Kirim ke Telegram API
                const telegramUrl = `https://api.telegram.org/bot${TELEGRAM_CONFIG.BOT_TOKEN}/sendMessage`;
                
                const response = await fetch(telegramUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        chat_id: TELEGRAM_CONFIG.CHAT_ID,
                        text: message,
                        parse_mode: 'HTML'
                    })
                });
                
                const result = await response.json();
                
                if (result.ok) {
                    // Success
                    if (source === 'direct') {
                        directResponseSendBtn.innerHTML = '‚úÖ Terkirim!';
                    } else {
                        sendFeedbackBtn.innerHTML = '‚úÖ Terkirim!';
                    }
                    
                    createFloatingHearts(20);
                    
                    // Simpan ke localStorage backup
                    saveFeedbackToLocalStorage(feedbackData);
                    
                    // Tampilkan confirmation setelah delay
                    setTimeout(() => {
                        showFeedbackConfirmation(feedbackData, source);
                    }, 1000);
                    
                } else {
                    throw new Error(result.description || 'Telegram API error');
                }
                
            } catch (error) {
                console.error('Error sending to Telegram:', error);
                
                // Fallback: Simpan ke localStorage
                if (source === 'direct') {
                    directResponseSendBtn.innerHTML = 'üíæ Sedang Mengirim...';
                } else {
                    sendFeedbackBtn.innerHTML = 'üíæ Sedang Mengirim...';
                }
                
                saveFeedbackToLocalStorage(feedbackData);
                
                // Tampilkan alert
                setTimeout(() => {
                    showFeedbackConfirmation(feedbackData, source);
                    alert('Jawabanmu sudah disimpan. Aku akan cek nanti ya!');
                }, 1000);
                
            } finally {
                // Reset button setelah 3 detik (kecuali test mode)
                if (!TELEGRAM_CONFIG.TEST_MODE) {
                    setTimeout(() => {
                        if (source === 'direct') {
                            directResponseSendBtn.innerHTML = 'Kirim Balasan üíå';
                            directResponseSendBtn.classList.remove('sending');
                            directResponseSendBtn.disabled = false;
                        } else {
                            sendFeedbackBtn.innerHTML = 'Kirim Jawabanku üíå';
                            sendFeedbackBtn.classList.remove('sending');
                            sendFeedbackBtn.disabled = false;
                        }
                    }, 3000);
                }
            }
        }
        
        function formatTelegramMessage(feedbackData, userIP) {
            const optionLabels = {
                'suka': 'üíñ <b>Aku Juga Merasa Sama</b>',
                'ragu': 'ü§î <b>Aku Masih Ragu</b>',
                'perlu_waktu': '‚è≥ <b>Aku Perlu Waktu</b>' 
            };
            
            return `
üíå <b>JAWABAN DARI SURAT CINTA!</b> üíå

üë§ <b>Kepada:</b> ${feedbackData.recipient}
üíñ <b>Perasaan:</b> ${optionLabels[feedbackData.option] || feedbackData.option}
${feedbackData.message ? `üìù <b>Pesan:</b>\n${feedbackData.message}\n` : ''}
üåê <b>IP:</b> ${userIP}
‚è∞ <b>Waktu:</b> ${new Date(feedbackData.timestamp).toLocaleString('id-ID')}

<i>Ayo cek websitenya!</i> üöÄ
            `;
        }
        
        function saveFeedbackToLocalStorage(feedbackData) {
            try {
                const allFeedback = JSON.parse(localStorage.getItem('suratCinta_feedback') || '[]');
                feedbackData.id = Date.now();
                allFeedback.push(feedbackData);
                localStorage.setItem('suratCinta_feedback', JSON.stringify(allFeedback));
            } catch (error) {
                console.error('Error saving to localStorage:', error);
            }
        }

        // === RESPONSE FUNCTIONS ===
        function showResponse(type) {
            const name = "Banun";
            let content = '';
            
            if (type === 'no') {
                content = `
                    <div style="font-size: 4em; margin-bottom: 20px;">ü§óüíù</div>
                    <h2 style="color: var(--rose); margin-bottom: 20px;">Terima Kasih</h2>
                    <p style="margin-bottom: 30px; font-size: 1.1em;">
                        Terima kasih sudah jujur ya, ${name}.<br>
                        Aku menghargai kejujuranmu, dan tidak apa-apa butuh waktu.
                    </p>
                    <p style="font-style: italic; margin-bottom: 30px; color: #666;">
                        "Hal terbaik datang kepada mereka yang menunggu"
                    </p>
                    <button onclick="closeModal()" class="modal-ok-btn">
                        Aku menghargaimu jawabanmu üí≠
                    </button>
                `;
                
                modalContent.innerHTML = content;
                responseModal.classList.add('active');
                document.body.style.overflow = 'hidden';
                
                // Kirim ke Telegram SETELAH MODAL DITAMPILKAN
                setTimeout(() => {
                    const feedbackData = {
                        option: 'perlu_waktu',
                        message: 'Aku Perlu Waktu',
                        recipient: "Musa",
                        timestamp: new Date().toISOString()
                    };
                    
                    // Kirim ke Telegram
                    sendToTelegram(feedbackData, 'no_response');
                    
                    // Notifikasi kecil bahwa sudah terkirim
                    showSentNotification();
                }, 500);
            }
        }

        // Fungsi notifikasi kecil
        function showSentNotification() {
            const notification = document.createElement('div');
            notification.innerHTML = 'üí≠ Jawabanmu sudah terkirim!';
            notification.style.cssText = `
                position: fixed; bottom: 100px; left: 50%;
                transform: translateX(-50%); background: var(--rose);
                color: white; padding: 12px 25px; border-radius: 25px;
                z-index: 10000; box-shadow: 0 5px 20px rgba(255,107,139,0.3);
                animation: fadeInUp 0.5s ease;
                font-family: 'Georgia', serif;
                font-size: 0.95em;
                border: 2px solid white;
            `;
            document.body.appendChild(notification);
            
            // Auto hilang setelah 3 detik
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(-50%) translateY(-10px)';
                setTimeout(() => notification.remove(), 500);
            }, 3000);
        }
        
        function showFeedbackConfirmation(feedbackData, source = 'feedback') {
            // Tutup modal yang sesuai
            if (source === 'direct') {
                hideDirectResponseModal();
            } else if (source === 'feedback') {
                hideFeedbackForm();
            }
            
            // Tentukan label berdasarkan option
            let responseLabel = '';
            if (feedbackData.option === 'suka') {
                responseLabel = 'üíñ Aku Juga Merasa Sama';
            } else if (feedbackData.option === 'ragu') {
                responseLabel = 'ü§î Aku masih ragu';
            } else if (feedbackData.option === 'perlu_waktu') {
                responseLabel = '‚è≥ Aku Perlu Waktu';  
            } else {
                responseLabel = feedbackData.option;
            }
            
            const content = `
                <div style="font-size: 4em; margin-bottom: 20px;">üéâüíå</div>
                <h2 style="color: var(--rose); margin-bottom: 20px;">Terima Kasih Sudah Jujur!</h2>
                
                <div style="background: var(--cream); padding: 20px; border-radius: 15px; margin: 20px 0; text-align: left;">
                    <h3 style="color: var(--deep-pink); margin-bottom: 10px;">Jawabanmu:</h3>
                    <p style="margin-bottom: 15px; font-size: 1.1em;">
                        <strong>${responseLabel}</strong>
                    </p>
                    ${feedbackData.message ? `
                    <h3 style="color: var(--deep-pink); margin-bottom: 10px;">Pesan Personalmu:</h3>
                    <p style="font-style: italic; background: white; padding: 15px; border-radius: 10px;">
                        "${feedbackData.message}"
                    </p>
                    ` : ''}
                </div>
                
                <p style="margin-bottom: 25px; font-size: 1.1em;">
                    Jawabanmu sudah sampai padaku! ‚ù§Ô∏è<br>
                    Aku sangat menghargai kejujuran dan keberanianmu.
                </p>
                
                <button onclick="closeModalAndCelebrate()" class="modal-confirm-btn">
                    Terima Kasih Banyak! üå∏
                </button>
            `;
            
            modalContent.innerHTML = content;
            responseModal.classList.add('active');
            
            // Celebration efek
            createFloatingHearts(30);
        }
        
        function closeModal() {
            responseModal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }
        
        function closeModalAndCelebrate() {
            closeModal();
            createFloatingHearts(50);
            setTimeout(() => {
                document.querySelector('.letter-header').scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'center' 
                });
            }, 500);
            setTimeout(() => {
                recipientName.textContent = "Untukmu Banun";
                recipientName.style.color = 'var(--deep-pink)';
                recipientName.style.fontSize = '';
                recipientName.style.fontFamily = '';
                // Big heart animation
                const bigHeart = document.createElement('div');
                bigHeart.innerHTML = 'üíñ';
                bigHeart.style.cssText = `
                    position: fixed;
                    top: 50%; left: 50%;
                    transform: translate(-50%, -50%) scale(0);
                    font-size: 100px;
                    z-index: 1000;
                    animation: heartExplode 1.5s ease-out forwards;
                    pointer-events: none;
                `;
                document.body.appendChild(bigHeart);
                setTimeout(() => bigHeart.remove(), 1500);
            }, 1000);
        }

        // === FITUR MUSIK TAMBAHAN ===
        function initializeMusicFeatures() {
            // 1. Inisialisasi lagu-lagu tambahan - 5 LAGU
            window.additionalTracks = [
                { id: 1, name: "Pandangan Pertama", file: "pelengkap1.mp3", emoji: "üíñ" },
                { id: 2, name: "Echanted", file: "pelengkap2.mp3", emoji: "üéµ" },
                { id: 3, name: "Kau Adalah", file: "pelengkap.mp3", emoji: "‚ú®" },
                { id: 4, name: "About You", file: "pelengkap3.mp3", emoji: "üé∂" },
                { id: 5, name: "Terbuang Dalam Waktu", file: "barasuara.mp3", emoji: "üéß" }
            ];

            window.currentTrack = 1; // Track aktif saat ini
            window.audioElements = [];

            // 2. Setup music selector
            setupMusicSelector();
        }

        // 3. Fungsi untuk setup fitur pilihan lagu
        function setupMusicSelector() {
            // Buat tombol pilih lagu
            const musicSelectorBtn = document.createElement('button');
            musicSelectorBtn.className = 'music-selector-btn';
            musicSelectorBtn.innerHTML = 'üé∂';
            musicSelectorBtn.title = 'Pilih Lagu';
            musicSelectorBtn.id = 'musicSelectorBtn';
            
            // Tempatkan tombol di music player
            const musicPlayer = document.getElementById('musicPlayer');
            if (musicPlayer) {
                musicPlayer.appendChild(musicSelectorBtn);
            }
            
            // Buat modal untuk pilihan lagu
            const musicSelectorModal = document.createElement('div');
            musicSelectorModal.className = 'music-selector-modal';
            musicSelectorModal.id = 'musicSelectorModal';
            
            // Isi modal dengan 5 opsi lagu
            musicSelectorModal.innerHTML = `
                <button class="selector-close" id="closeMusicSelector">‚úï</button>
                <div class="selector-title">üéµ Pilih Lagu</div>
                ${window.additionalTracks.map(track => `
                    <div class="music-option ${track.id === 1 ? 'active' : ''}" data-track="${track.id}">
                        <span class="option-emoji">${track.emoji}</span>
                        <span class="option-text">${track.name}</span>
                    </div>
                `).join('')}
            `;
            
            document.body.appendChild(musicSelectorModal);
            
            // Event listeners untuk music selector
            document.getElementById('musicSelectorBtn').addEventListener('click', function(e) {
                e.stopPropagation();
                musicSelectorModal.classList.toggle('show');
            });
            
            document.getElementById('closeMusicSelector').addEventListener('click', function(e) {
                e.stopPropagation();
                musicSelectorModal.classList.remove('show');
            });
            
            // Event listener untuk pilihan lagu
            document.querySelectorAll('.music-option').forEach(option => {
                option.addEventListener('click', function() {
                    const trackId = parseInt(this.getAttribute('data-track'));
                    if (trackId !== window.currentTrack) {
                        switchTrack(trackId);
                    }
                    musicSelectorModal.classList.remove('show');
                });
            });
            
            // Tutup modal saat klik di luar
            document.addEventListener('click', function(event) {
                if (!musicSelectorModal.contains(event.target) && 
                    !musicSelectorBtn.contains(event.target) &&
                    musicSelectorModal.classList.contains('show')) {
                    musicSelectorModal.classList.remove('show');
                }
            });
            
            // Inisialisasi audio elements
            initializeAudioElements();
        }

        // 4. Fungsi untuk inisialisasi audio elements untuk 5 lagu
        function initializeAudioElements() {
            // Inisialisasi untuk track 4 dan 5 (track 1-3 sudah ada di backgroundMusic)
            const track4 = document.getElementById('musicTrack4');
            const track5 = document.getElementById('musicTrack5');
            
            if (track4) {
                track4.loop = true;
                track4.volume = currentVolume;
                window.audioElements[4] = track4;
            }
            
            if (track5) {
                track5.loop = true;
                track5.volume = currentVolume;
                window.audioElements[5] = track5;
            }
            
            // Set backgroundMusic sebagai track 1
            window.audioElements[1] = backgroundMusic;
            
            // Untuk track 2 dan 3, buat audio element baru karena tidak ada di HTML
            for (let i = 2; i <= 3; i++) {
                const track = window.additionalTracks.find(t => t.id === i);
                if (track && !window.audioElements[i]) {
                    const audio = new Audio(track.file);
                    audio.loop = true;
                    audio.volume = currentVolume;
                    window.audioElements[i] = audio;
                }
            }
        }

        // 5. Fungsi untuk ganti track
        function switchTrack(trackId) {
            if (trackId === window.currentTrack) return;
            
            // Simpan status play/pause
            const wasPlaying = isMusicPlaying;
            
            // Pause track yang sedang aktif
            if (isMusicPlaying) {
                pauseBackgroundMusic();
            }
            
            // Update current track
            window.currentTrack = trackId;
            
            // Update backgroundMusic source
            backgroundMusic.pause();
            
            // Cari file yang sesuai
            const selectedTrack = window.additionalTracks.find(t => t.id === trackId);
            if (selectedTrack) {
                // Cek apakah audio element sudah ada di cache
                if (window.audioElements[trackId]) {
                    backgroundMusic.src = selectedTrack.file;
                } else {
                    backgroundMusic.src = selectedTrack.file;
                }
            }
            
            backgroundMusic.load();
            backgroundMusic.volume = currentVolume;
            
            // Update UI untuk track aktif
            document.querySelectorAll('.music-option').forEach(option => {
                option.classList.remove('active');
                if (parseInt(option.getAttribute('data-track')) === trackId) {
                    option.classList.add('active');
                }
            });
            
            // Jika sebelumnya sedang play, play track baru
            if (wasPlaying) {
                setTimeout(() => {
                    playBackgroundMusic();
                }, 100);
            }
            
            // Efek visual
            createFloatingHearts(5);
        }

        // 6. Override fungsi updateVolume untuk update semua track
        const originalUpdateVolume = updateVolume;
        window.updateVolume = function() {
            originalUpdateVolume();
            
            // Update volume untuk semua audio elements
            Object.values(window.audioElements).forEach(audio => {
                if (audio) {
                    audio.volume = currentVolume;
                }
            });
        };

        // === TOUR GUIDE UNLIMITED FUNCTIONS ===
        function initializeTourGuide() {
            // Tambah hint button saat music player muncul
            const checkMusicPlayer = setInterval(() => {
                const musicPlayer = document.getElementById('musicPlayer');
                if (musicPlayer && musicPlayer.style.display !== 'none') {
                    clearInterval(checkMusicPlayer);
                    
                    // Tunggu 1 detik
                    setTimeout(() => {
                        // Tambah hint button (akan selalu ada)
                        addHintButton();
                        
                        console.log('‚úÖ Tour guide features initialized');
                    }, 1000);
                }
            }, 500);
        }

        // Fungsi untuk show music guide (UNLIMITED - bisa dipanggil kapan saja)
        function showMusicGuide() {
            // Hapus guide sebelumnya jika ada
            const oldGuide = document.getElementById('musicGuide');
            if (oldGuide) oldGuide.remove();
            
            // Buat elemen guide baru
            const guide = document.createElement('div');
            guide.id = 'musicGuide';
            guide.innerHTML = `
                <div class="guide-content">
                    <div class="guide-header">
                        <span class="guide-icon">üéµ</span>
                        <h3>Tips Kecil!</h3>
                        <button class="guide-close" onclick="closeGuide()">‚úï</button>
                    </div>
                    <div class="guide-body">
                        <p>Kamu bisa pilih lagu yang udah ku siapin nih. <span class="highlight-emoji">üé∂</span></p>
                        <div class="guide-animation">
                            <div class="arrow">üëá</div>
                            <div class="music-btn-demo">üé∂</div>
                        </div>
                        <p class="guide-tip">Ada 5 lagu yang bisa kamu pilih sesuai kemauan mu.</p>
                    </div>
                    <div class="guide-footer">
                        <button class="guide-ok-btn" onclick="closeGuide()">Oke, mengerti!</button>
                        <button class="guide-show-btn" onclick="showMusicSelectorGuide()">Tunjukkan Sekarang</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(guide);
            
            // Auto close setelah 10 detik
            setTimeout(() => {
                if (document.getElementById('musicGuide')) {
                    closeGuide();
                }
            }, 10000);
        }

        // Fungsi close guide
        function closeGuide() {
            const guide = document.getElementById('musicGuide');
            if (guide) {
                guide.style.animation = 'fadeOut 0.5s ease forwards';
                setTimeout(() => guide.remove(), 500);
            }
        }

        // Fungsi show music selector guide
        function showMusicSelectorGuide() {
            closeGuide();
            
            // Tunjukkan tombol music selector
            const musicSelectorBtn = document.getElementById('musicSelectorBtn');
            if (musicSelectorBtn) {
                // Highlight tombol
                musicSelectorBtn.classList.add('pulse-attention');
                musicSelectorBtn.style.transform = 'scale(1.3)';
                
                // Auto click setelah 1 detik
                setTimeout(() => {
                    musicSelectorBtn.click();
                }, 1000);
                
                // Reset setelah 3 detik
                setTimeout(() => {
                    musicSelectorBtn.classList.remove('pulse-attention');
                    musicSelectorBtn.style.transform = '';
                }, 3000);
            }
        }

        // Fungsi add hint button (selalu ada)
        function addHintButton() {
            // Hapus hint button sebelumnya jika ada
            const oldHintBtn = document.getElementById('musicHintBtn');
            if (oldHintBtn) oldHintBtn.remove();
            
            const hintBtn = document.createElement('button');
            hintBtn.id = 'musicHintBtn';
            hintBtn.className = 'hint-button';
            hintBtn.innerHTML = 'üí°';
            hintBtn.title = 'Tips pilih lagu';
            
            hintBtn.addEventListener('click', function() {
                showQuickHint();
            });
            
            document.body.appendChild(hintBtn);
            
            // Tambah pulse effect setiap 30 detik untuk menarik perhatian
            setInterval(() => {
                if (!document.querySelector('.music-selector-modal.show')) {
                    hintBtn.classList.add('pulse-attention');
                    setTimeout(() => {
                        hintBtn.classList.remove('pulse-attention');
                    }, 3000);
                }
            }, 30000);
        }

        // Fungsi show quick hint
        function showQuickHint() {
            // Hapus hint sebelumnya
            const oldHint = document.querySelector('.quick-hint');
            if (oldHint) oldHint.remove();
            
            const hint = document.createElement('div');
            hint.className = 'quick-hint';
            hint.innerHTML = `
                <div class="hint-bubble">
                    <p><strong>Kamu bisa pilih lagu nih</strong></p>
                    <p>Klik tombol <span class="hint-emoji">üé∂</span> di bawah</p>
                    <p>Ada 5 pilihan lagu yang kusiapkan untukmu</p>
                    <div class="hint-arrow">‚Üë‚Üë‚Üë</div>
                </div>
            `;
            
            document.body.appendChild(hint);
            
            // Auto hilang
            setTimeout(() => {
                hint.style.opacity = '0';
                hint.style.transform = 'translateY(10px)';
                setTimeout(() => hint.remove(), 500);
            }, 4000);
        }

        // === GLOBAL FUNCTIONS ===
        window.closeModal = closeModal;
        window.closeModalAndCelebrate = closeModalAndCelebrate;
        window.showFeedbackForm = showFeedbackForm;
        window.hideFeedbackForm = hideFeedbackForm;
        window.showMusicGuide = showMusicGuide;
        window.closeGuide = closeGuide;
        window.showMusicSelectorGuide = showMusicSelectorGuide;
        window.switchTrack = switchTrack;
        window.hideConfirmationModal = hideConfirmationModal;
        window.hideDirectResponseModal = hideDirectResponseModal;
    </script>
</body>
</html>
